# 国标麻将规则笔记

> 资料来源：https://wiki.botzone.org.cn/index.php?title=Chinese-Standard-Mahjong

## 简介

开局各个玩家各持有**13张**手牌。

国标麻将**8番起胡**。

在Botzone中，只打一局。

主要判定顺序：逆时针

## 游戏规则

### 发牌

每人先发13张牌。

### 确定庄家

0号玩家为庄家（东）。逆时针方向四名玩家编号依次为0、1、2、3（东、南、西、北

### 出牌

由庄家开始，每回合都是摸一张牌打一张牌。**当牌山被取尽还没有和牌时，宣告平局。**

### 牌的构成

一副144枚牌，由花牌、数牌、风牌和箭牌构成。

- **花牌**：春夏秋冬梅兰竹菊各一张。

- **数牌**：分为饼、条、万三种花色，每种花色各有数字为1~9的牌，每种数牌各有4枚。例：3饼、2万。

- **风牌**：分为东南西北四种风牌，每种风牌各有4枚。例：东风。

- **箭牌**：分为中发白三种箭牌，每种箭牌各有4枚。例：白板。

### 和牌

#### 和牌方式

和牌方式有两种：

- 自摸和牌。
- 别人点炮和（含抢杠胡）。

#### 和牌牌型组成

除了特殊和牌十三幺、七星不靠、全不靠、组合龙、连七对、七对之外，和牌牌型一般由四个面子和一个对子组成。对子由相同的两枚牌构成，面子则分为顺子、刻子、杠子。

- **顺子**：由相同花色的三张连续数字的数牌构成，比如：一二三万，七八九万，但是八九一万不构成顺子。

- **刻子**：由相同花色的三张相同数字的数牌或字牌构成，比如：二二二万，南南南风。

- **杠子**：由相同花色的四张相同数字的数牌或字牌构成，比如：二二二二万，南南南南风。

### 鸣牌

鸣牌包括吃、碰、杠。优先级为**碰=杠>吃**。

- **吃牌**：一般状态下，在**没有其他家要碰的时候**，可以吃**上家**打出的牌，要求是手中有能和上家打出的牌组成顺子的牌，不能从鸣牌的牌中取。不能吃对家和下家的牌，也不能吃自己的牌。

- **碰牌**：可以碰任意一家打出的牌，要求是手中有能和打出的牌一样的两张或三张牌，同样的，不能从鸣牌的牌中取，不能碰自己刚刚打出的牌。

- **杠牌**：分为明杠、补杠、暗杠。明杠指的是手中有能和打出的牌一样的三张牌，其他要求同碰牌；补杠指的是自己已经鸣牌碰了某花色的牌，手里拿到了第四张，进行补杠操作，使得这个鸣牌的面子由刻子变为杠子；暗杠指的是手中有能和打出的牌一样的四张牌。明杠只有在别家打出牌之后能进行，补杠和暗杠只有在己家摸牌后、打牌前能进行，补杠需要在没有人抢杠和牌时成立。暗杠后其余三家无法获知什么牌被暗杠了。

### 算分规则

国标麻将的分数计算需要计算和牌时的番数及和牌的类型。

#### 胡牌人数

一盘只能有**一位**和牌者。如有一人以上同时表示和牌时，从打牌者按**逆时针方向**，**顺序在前者**被定为“和牌者”。

#### 错和

国标8番起和。若Bot在游戏过程中发生错误，返回的操作不合法，和牌时不是和牌牌型或未到8番错和，**发生错误的玩家-30分，其余玩家+10分**，游戏结束。若有多个玩家同时出错，按“东南西北”的顺序判定第一个出错玩家。

#### 正常和牌

正常和牌后的各方得分：

- 底分=8分

- 胜方：
  - 自摸和牌：(底分+和牌番数)×3
  - 别人点炮和：底分×3+番种分数

- 负方：
  - 点炮者：-（底分+番种分数）
  - 非点炮者：-底分
  - 自摸和牌：-（底分+番种分数）

## 麻将牌的表示

所有麻将牌均以“大写字母+数字”组合表示。

如：“W4”表示“四万”，“B6”表示“六筒”，“T8”表示“8条”

“F1”～“F4”表示“东南西北”，“J1”～“J3”表示“中发白”，“H1”～“H8”表示“春夏秋冬梅兰竹菊”

### Bot输入输出

#### 输入request

| request的格式 |                                                              |                                       |                                                              |
| :-----------: | ------------------------------------------------------------ | ------------------------------------- | ------------------------------------------------------------ |
|     编号      | 信息格式                                                     | 样例                                  | 说明                                                         |
|       0       | 0 playerID quan                                              | 0 1 2                                 | 该信息只会出现在第一回合，playerID表示你的位置（门风），quan表示当前风圈。 |
|       1       | 1 hua0 hua1 hua2 hua3 Card1 Card2 ... Card13 HCard01 ... HCard0hua1 ... HCard31 ... HCard3hua3 | 1 1 2 1 1 W1 B1 ... T3 H1 H4 H2 H3 H6 | 该信息只会出现在第二回合，hua0～hua3表示四个玩家摸到的花牌数，Card1～Card13表示初始手牌，后面的hua0+...+hua3张牌表示所有人摸到的花牌。 保证Card1～Card13没有花牌，后面的均为花牌。 |
|       2       | 2 Card1                                                      | 2 T6                                  | 表示玩家摸牌摸到Card1，保证Card1不是花牌。                   |
|       3       | 3 playerID BUHUA Card1                                       | 3 2 BUHUA H7                          | 该消息会发送给所有玩家，表示玩家摸牌摸到花牌Card1，并补花。  |
|       4       | 3 playerID DRAW                                              | 3 2 DRAW                              | 表示其他玩家进行了摸牌操作。                                 |
|       5       | 3 playerID PLAY Card1                                        | 3 2 PLAY T1                           | 该消息会发送给所有玩家，表示玩家摸牌后，直接打出了Card1。    |
|       6       | 3 playerID PENG Card1                                        | 3 2 PENG Card1                        | 该消息会发送给所有玩家，表示玩家进行了碰牌操作，碰的牌为上一回合打出的牌，并打出了Card1。 |
|       7       | 3 playerID CHI Card1 Card2                                   | 3 2 CHI T2 W3                         | 该消息会发送给所有玩家，表示玩家进行了吃牌操作，吃牌后的顺子，**中间牌**为Card1，并打出Card2。 |
|       8       | 3 playerID GANG                                              | 3 2 GANG                              | 该消息会发送给所有玩家，表示玩家进行了杠牌操作，**若上一回合为摸牌，表示进行暗杠，否则杠上回合打出的牌。** |
|       9       | 3 playerID BUGANG Card1                                      | 3 2 BUGANG W3                         | 该消息会发送给所有玩家，表示玩家进行了补杠操作，补杠Card1。  |



#### 输出response

| response的格式  |            |                                                              |                                                              |
| :-------------: | ---------- | ------------------------------------------------------------ | ------------------------------------------------------------ |
|      编号       | 信息格式   | 样例                                                         | 说明                                                         |
|        0        | PASS       | PASS                                                         | 表示Bot成功获得位置和风圈信息。                              |
|        1        | PASS       | PASS                                                         | 表示Bot成功获得初始手牌信息。                                |
|        2        | PLAY Card1 | PLAY T6                                                      | 表示玩家摸牌后，直接打出Card1。                              |
|   GANG Card1    | GANG T6    | 表示玩家摸牌后，手牌存在四张Card1，进行杠牌，**成功后会再次摸牌。** |                                                              |
|  BUGANG Card1   | BUGANG T6  | 表示玩家摸牌摸到一张牌，之前碰过这张牌，进行**补杠，成功后会再次摸牌。** |                                                              |
|       HU        | HU         | 表示玩家进行和牌，**此命令后无论是否和牌，游戏结束。**       |                                                              |
|        3        | PASS       | PASS                                                         | 表示Bot成功获得补花信息。                                    |
|        4        | PASS       | PASS                                                         | 表示Bot成功获得其他玩家摸牌信息。                            |
|      5 6 7      | PASS       | PASS                                                         | 表示Bot成功获得打牌信息，**玩家自己的吃、碰、杠牌操作是否成功，请在此处判断。** |
|   PENG Card1    | PENG T6    | 表示玩家手牌中有2张上一回合其他玩家打出的牌，想要进行碰牌，并打出Card1。 |                                                              |
| CHI Card1 Card2 | CHI T2 T5  | 需要上回合为玩家上家出牌，表示玩家手牌加上上一回合其他玩家打出的牌能组成的顺子，中间牌为Card1，想要进行吃牌，并打出Card2。 |                                                              |
|      GANG       | GANG       | 表示玩家手牌中有3张上一回合其他玩家打出的牌，想要进行杠牌，**成功后，下回合由该玩家开始摸牌。** |                                                              |
|       HU        | HU         | 表示玩家想要和牌，此命令后无论是否和牌，游戏结束。           |                                                              |
|        8        | PASS       | PASS                                                         | 表示Bot成功获得杠牌信息。                                    |
|        9        | PASS       | PASS                                                         | 表示Bot成功获得补杠信息。                                    |
|       HU        | HU         | 表示玩家想要抢杠和，此命令后无论是否和牌，游戏结束。         |                                                              |


对于5 6 7号操作，由于和牌、吃牌、碰/杠牌可能同时出现，现规定其优先级如下：

**和牌 > 碰/杠牌 > 吃牌**

由于5 6 7操作可能失败，需要玩家**自行**通过下一回合的输入判断操作是否成功。